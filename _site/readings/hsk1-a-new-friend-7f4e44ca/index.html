<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[HSK1] A New Friend (Êñ∞ÊúãÂèã) | Mandarin HSK Study Site</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="/assets/css/styles.css">  
    
</head>
<body>
    <!-- Bootstrap JS (for Popovers) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            <a class="navbar-brand" href="/">Mandarin HSK Study Site</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link" href="/lessons">Lessons</a></li>
                    <li class="nav-item"><a class="nav-link" href="/readings">Readings</a></li>
                    <li class="nav-item"><a class="nav-link" href="https://chatgpt.com/g/g-67a2f171c0dc8191a6ba6d87bbc9ee91-mandarin-pronunciation-guide"><i class="bi bi-box-arrow-up-right"> ChatGPT Ê±âÂ≠ó Coach.</i></a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="container">
    <br />
    <br />
    <div class="d-flex justify-content-between align-items-center">
        <h1>[HSK1] A New Friend (Êñ∞ÊúãÂèã)</h1>
    </div>
    <p class="plain-text-body">
</p>
    <br />
    <br />
    <br />
    <br />
    <div class="d-flex justify-content-between align-items-center">
        <h2>Dialogs</h2>
        <div>
            <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="togglePinyin">
                <label class="form-check-label" for="togglePinyin">Show Pinyin</label>
            </div>
            <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="toggleTranslation">
                <label class="form-check-label" for="toggleTranslation">Show Translation</label>
            </div>
        </div>
    </div>


    <div class="hanzi-section" 
        data-title="[HSK1] A New Friend (Êñ∞ÊúãÂèã)"
        data-hanzi="‰ªäÂ§©ÊòØÊòüÊúü‰∏âÔºåÂ§©Ê∞îÂæàÂ•ΩÔºå‰∏ç‰∏ãÈõ®Ôºå‰πü‰∏çÂ§™ÁÉ≠„ÄÇ

ÊùéÊúàÊòØÂ≠¶ÁîüÔºåÂ•πÂú®‰∏≠ÂõΩÂ≠¶‰π†Ê±âËØ≠„ÄÇ‰ªäÂπ¥Â•π‰∫åÂçÅ‰∏ÄÂ≤Å‰∫Ü„ÄÇ

‰∏äÂçàÔºåÂ•πÂéªÂ≠¶Ê†°Áúã‰π¶ÔºåÂ≠¶‰π†Ê±âÂ≠ó„ÄÇËÄÅÂ∏àÈóÆÔºö‚ÄúËØ∑ÈóÆÔºå‰Ω†Âè´‰ªÄ‰πàÂêçÂ≠óÔºü‚Äù Â•πËØ¥Ôºö‚ÄúÊàëÂè´ÊùéÊúà„ÄÇ‚Äù ËÄÅÂ∏àÁ¨ë‰∫ÜÔºåËØ¥Ôºö‚Äú‰Ω†ÊòØ‰∏≠ÂõΩ‰∫∫ÂêóÔºü‚Äù ÊùéÊúàËØ¥Ôºö‚Äú‰∏çÔºåÊàëÊòØÁæéÂõΩ‰∫∫„ÄÇ‚Äù

‰∏≠ÂçàÔºåÂ•πÂéªÈ•≠Â∫óÂêÉÈ•≠„ÄÇÂ•πÊÉ≥ÂêÉÁ±≥È•≠ÂíåËèúÔºå‰πüÊÉ≥ÂñùËå∂„ÄÇÂ•πÈóÆÔºö‚ÄúËØ∑ÈóÆÔºåËøô‰∫õËèúÂ§öÂ∞ëÈí±Ôºü‚Äù ÂÖàÁîüËØ¥Ôºö‚Äú‰∏Ä‰∏™ËèúÂÖ´ÂùóÔºå‰∏Ä‰∏™ÊùØÂ≠ê‰∏âÂùó„ÄÇ‚Äù Â•πËØ¥Ôºö‚ÄúÂ•ΩÔºåÊàë‰π∞Ëøô‰∫õ„ÄÇ‚Äù

‰∏ãÂçàÔºåÂ•πÂéªÂïÜÂ∫ó‰π∞‰∏úË•ø„ÄÇÂ•π‰π∞‰∫Ü‰∏ÄÁÇπÂÑøÊ∞¥ÊûúÂíå‰∏ÄÊú¨‰π¶„ÄÇÂ•πÂú®ÂïÜÂ∫óÁúãËßÅ‰∏Ä‰∏™Â≠¶Áîü„ÄÇÂ•πÈóÆÔºö‚ÄúËØ∑ÈóÆÔºå‰Ω†Âè´‰ªÄ‰πàÂêçÂ≠óÔºü‚Äù ‰ªñËØ¥Ôºö‚ÄúÊàëÂè´ÁéãÊñπ„ÄÇ‚Äù

ÊùéÊúàËØ¥Ôºö‚Äú‰Ω†ÊòØÊàëÁöÑÂêåÂ≠¶ÂêóÔºü‚Äù ÁéãÊñπËØ¥Ôºö‚ÄúÊòØÔºÅÊàë‰ª¨Âú®‰∏Ä‰∏™Â≠¶Ê†°Â≠¶‰π†„ÄÇ‚Äù ÊùéÊúàÈ´òÂÖ¥Âú∞ËØ¥Ôºö‚ÄúÂ§™Â•Ω‰∫ÜÔºÅÊàë‰ª¨ÊòØÊúãÂèã„ÄÇ‚Äù

Êôö‰∏äÔºå‰ªñ‰ª¨‰∏ÄËµ∑ÂéªÁúãÁîµÂΩ±„ÄÇÁéãÊñπÈóÆÔºö‚Äú‰Ω†ÂñúÊ¨¢Ëøô‰∏™ÁîµÂΩ±ÂêóÔºü‚Äù ÊùéÊúàËØ¥Ôºö‚ÄúÂñúÊ¨¢ÔºÅ‚Äù ‰ªñ‰ª¨ÂæàÈ´òÂÖ¥„ÄÇ

ÔºàÂÆåÔºâ" 
        data-translation="W1si5LuK5aSp5piv5pif5pyf5LiJ77yM5aSp5rCU5b6I5aW977yM5LiN5LiL6Zuo77yM5Lmf5LiN5aSq54Ot44CCIiwiVG9kYXkgaXMgV2VkbmVzZGF5LCB0aGUgd2VhdGhlciBpcyB2ZXJ5IG5pY2UsIGl0IGlzIG5vdCByYWluaW5nLCBhbmQgaXQgaXMgbm90IHRvbyBob3QuIl0sWyLmnY7mnIjmmK%2FlrabnlJ%2FvvIzlpbnlnKjkuK3lm73lrabkuaDmsYnor63jgILku4rlubTlpbnkuozljYHkuIDlsoHkuobjgIIiLCJMaSBZdWUgaXMgYSBzdHVkZW50LCBzaGUgaXMgc3R1ZHlpbmcgQ2hpbmVzZSBpbiBDaGluYS4gVGhpcyB5ZWFyIHNoZSBpcyB0d2VudHktb25lIHllYXJzIG9sZC4iXSxbIuS4iuWNiO%2B8jOWlueWOu%2BWtpuagoeeci%2BS5pu%2B8jOWtpuS5oOaxieWtl%2BOAgiIsIkluIHRoZSBtb3JuaW5nLCBzaGUgd2VudCB0byBzY2hvb2wgdG8gcmVhZCBib29rcyBhbmQgbGVhcm4gQ2hpbmVzZSBjaGFyYWN0ZXJzLiJdLFsi6ICB5biI6Zeu77ya4oCc6K%2B36Zeu77yM5L2g5Y%2Br5LuA5LmI5ZCN5a2X77yf4oCdIiwiVGhlIHRlYWNoZXIgYXNrZWQ6ICdFeGN1c2UgbWUsIHdoYXQgaXMgeW91ciBuYW1lPyciXSxbIuWlueivtO%2B8muKAnOaIkeWPq%2BadjuaciOOAguKAnSIsIlNoZSBzYWlkOiAnTXkgbmFtZSBpcyBMaSBZdWUuJyJdLFsi6ICB5biI56yR5LqG77yM6K%2B077ya4oCc5L2g5piv5Lit5Zu95Lq65ZCX77yf4oCdIiwiVGhlIHRlYWNoZXIgc21pbGVkIGFuZCBzYWlkOiAnQXJlIHlvdSBDaGluZXNlPyciXSxbIuadjuaciOivtO%2B8muKAnOS4je%2B8jOaIkeaYr%2Be%2BjuWbveS6uuOAguKAnSIsIkxpIFl1ZSBzYWlkOiAnTm8sIEkgYW0gQW1lcmljYW4uJyJdLFsi5Lit5Y2I77yM5aW55Y676aWt5bqX5ZCD6aWt44CCIiwiQXQgbm9vbiwgc2hlIHdlbnQgdG8gYSByZXN0YXVyYW50IHRvIGVhdC4iXSxbIuWlueaDs%2BWQg%2Bexs%2BmlreWSjOiPnO%2B8jOS5n%2BaDs%2BWWneiMtuOAgiIsIlNoZSB3YW50ZWQgdG8gZWF0IHJpY2UgYW5kIGRpc2hlcywgYW5kIGFsc28gd2FudGVkIHRvIGRyaW5rIHRlYS4iXSxbIuWluemXru%2B8muKAnOivt%2BmXru%2B8jOi%2FmeS6m%2BiPnOWkmuWwkemSse%2B8n%2BKAnSIsIlNoZSBhc2tlZDogJ0V4Y3VzZSBtZSwgaG93IG11Y2ggYXJlIHRoZXNlIGRpc2hlcz8nIl0sWyLlhYjnlJ%2For7TvvJrigJzkuIDkuKroj5zlhavlnZfvvIzkuIDkuKrmna%2FlrZDkuInlnZfjgILigJ0iLCJUaGUgbWFuIHNhaWQ6ICdPbmUgZGlzaCBpcyBlaWdodCB5dWFuLCBvbmUgY3VwIGlzIHRocmVlIHl1YW4uJyJdLFsi5aW56K%2B077ya4oCc5aW977yM5oiR5Lmw6L%2BZ5Lqb44CC4oCdIiwiU2hlIHNhaWQ6ICdPa2F5LCBJIHdpbGwgYnV5IHRoZXNlLiciXSxbIuS4i%2BWNiO%2B8jOWlueWOu%2BWVhuW6l%2BS5sOS4nOilv%2BOAgiIsIkluIHRoZSBhZnRlcm5vb24sIHNoZSB3ZW50IHRvIHRoZSBzdG9yZSB0byBidXkgdGhpbmdzLiJdLFsi5aW55Lmw5LqG5LiA54K55YS%2F5rC05p6c5ZKM5LiA5pys5Lmm44CCIiwiU2hlIGJvdWdodCBhIGxpdHRsZSBmcnVpdCBhbmQgYSBib29rLiJdLFsi5aW55Zyo5ZWG5bqX55yL6KeB5LiA5Liq5a2m55Sf44CCIiwiU2hlIHNhdyBhIHN0dWRlbnQgaW4gdGhlIHN0b3JlLiJdLFsi5aW56Zeu77ya4oCc6K%2B36Zeu77yM5L2g5Y%2Br5LuA5LmI5ZCN5a2X77yf4oCdIiwiU2hlIGFza2VkOiAnRXhjdXNlIG1lLCB3aGF0IGlzIHlvdXIgbmFtZT8nIl0sWyLku5bor7TvvJrigJzmiJHlj6vnjovmlrnjgILigJ0iLCJIZSBzYWlkOiAnTXkgbmFtZSBpcyBXYW5nIEZhbmcuJyJdLFsi5p2O5pyI6K%2B077ya4oCc5L2g5piv5oiR55qE5ZCM5a2m5ZCX77yf4oCdIiwiTGkgWXVlIHNhaWQ6ICdBcmUgeW91IG15IGNsYXNzbWF0ZT8nIl0sWyLnjovmlrnor7TvvJrigJzmmK%2FvvIHmiJHku6zlnKjkuIDkuKrlrabmoKHlrabkuaDjgILigJ0iLCJXYW5nIEZhbmcgc2FpZDogJ1llcyEgV2Ugc3R1ZHkgYXQgdGhlIHNhbWUgc2Nob29sLiciXSxbIuadjuaciOmrmOWFtOWcsOivtO%2B8muKAnOWkquWlveS6hu%2B8geaIkeS7rOaYr%2Baci%2BWPi%2BOAguKAnSIsIkxpIFl1ZSBoYXBwaWx5IHNhaWQ6ICdHcmVhdCEgV2UgYXJlIGZyaWVuZHMuJyJdLFsi5pma5LiK77yM5LuW5Lus5LiA6LW35Y6755yL55S15b2x44CCIiwiSW4gdGhlIGV2ZW5pbmcsIHRoZXkgd2VudCB0byB3YXRjaCBhIG1vdmllIHRvZ2V0aGVyLiJdLFsi546L5pa56Zeu77ya4oCc5L2g5Zac5qyi6L%2BZ5Liq55S15b2x5ZCX77yf4oCdIiwiV2FuZyBGYW5nIGFza2VkOiAnRG8geW91IGxpa2UgdGhpcyBtb3ZpZT8nIl0sWyLmnY7mnIjor7TvvJrigJzllpzmrKLvvIHigJ0iLCJMaSBZdWUgc2FpZDogJ0kgbGlrZSBpdCEnIl0sWyLku5bku6zlvojpq5jlhbTjgIIiLCJUaGV5IHdlcmUgdmVyeSBoYXBweS4iXSxbIu%2B8iOWujO%2B8iSIsIihUaGUgRW5kKSJdXQ%3D%3D"
        data-dictionary="eyLku4rlpKkiOiIodCkgIHRvZGF5Iiwi5pivIjoiKHYpICB2YXJpYW50IG9mIOaYr1tzaGk0XSIsIuaYn%2Bacn%2BS4iSI6Iih0KSAgV2VkbmVzZGF5Iiwi5aSp5rCUIjoiKG4pICB3ZWF0aGVyIiwi5b6IIjoiKHpnKSAgdmVyeTsgcXVpdGUiLCLlpb0iOiIoYSkgIHRvIGJlIGZvbmQgb2Y7IHRvIGhhdmUgYSB0ZW5kZW5jeSB0bzsgdG8gYmUgcHJvbmUgdG8iLCLkuZ8iOiIoZCkgIGFsc287IHRvbzsgYXMgd2VsbDsgKG5vdCAuLi4pIGVpdGhlciIsIuWtpueUnyI6IihuKSAgc3R1ZGVudCIsIuWluSI6IihyKSAgc2hlIiwi5ZyoIjoiKHApICB0byBleGlzdDsgdG8gYmUgYWxpdmUiLCLkuK3lm70iOiIobnMpICBDaGluYSIsIuWtpuS5oCI6Iih2KSAgdG8gbGVhcm4iLCLmsYnor60iOiIobnopICBDaGluZXNlIGxhbmd1YWdlIiwi5LuK5bm0IjoiKHQpICB0aGlzIHllYXIiLCLkuoYiOiIodWwpICB1bm9mZmljaWFsIHZhcmlhbnQgb2Yg556tW2xpYW80XSIsIuS4iuWNiCI6Iih0KSAgbW9ybmluZyIsIuWOuyI6Iih2KSAgdG8gZ28iLCLlrabmoKEiOiIobikgIHNjaG9vbCIsIueci%2BS5piI6Iih2KSAgdG8gcmVhZCIsIuaxieWtlyI6IihueikgIENoaW5lc2UgY2hhcmFjdGVyKHMpIiwi6ICB5biIIjoiKG4pICB0ZWFjaGVyIiwi6ZeuIjoiKG4pICB0byBhc2s7IHRvIGlucXVpcmUiLCLor7fpl64iOiIodikgIEV4Y3VzZSBtZSwgbWF5IEkgYXNrLi4uPyIsIuS9oCI6IihyKSAgeW91IChOb3RlOiBJbiBUYWl3YW4sIOWmsyBpcyB1c2VkIHRvIGFkZHJlc3MgZmVtYWxlcywgYnV0IGluIG1haW5sYW5kIENoaW5hLCBpdCBpcyBub3QgY29tbW9ubHkgdXNlZC4gSW5zdGVhZCwg5L2gIGlzIHVzZWQgdG8gYWRkcmVzcyBib3RoIG1hbGVzIGFuZCBmZW1hbGVzLikiLCLlj6siOiIodikgIHZhcmlhbnQgb2Yg5Y%2BrW2ppYW80XSIsIuS7gOS5iCI6IihyKSAgd2hhdD8iLCLlkI3lrZciOiIobikgIG5hbWUgKG9mIGEgcGVyc29uIG9yIHRoaW5nKSIsIuaIkSI6IihyKSAgSTsgbWU7IG15Iiwi5p2OIjoiKG5yKSAgcGx1bSIsIuaciCI6IihtKSAgbW9vbiIsIueskSI6Iih2KSAgdG8gbGF1Z2g7IHRvIHNtaWxlIiwi6K%2B0IjoiKHYpICB2YXJpYW50IG9mIOiqqnzor7Rbc2h1bzFdIiwi5LiNIjoiKGQpICBubzsgbm90IHNvIiwi576O5Zu9IjoiKG5zKSAgVW5pdGVkIFN0YXRlczsgVVNBOyBVUyIsIuS6uiI6IihuKSAgcGVyc29uOyBwZW9wbGUiLCLkuK3ljYgiOiIodCkgIG5vb24iLCLppa3lupciOiIobikgIHJlc3RhdXJhbnQiLCLlkIPppa0iOiIodikgIHRvIGhhdmUgYSBtZWFsIiwi5oOzIjoiKHYpICB0byB0aGluayAoYWJvdXQpIiwi5ZCDIjoiKHYpICB2YXJpYW50IG9mIOWQg1tjaGkxXSIsIuexs%2BmlrSI6IihuKSAgKGNvb2tlZCkgcmljZSIsIuWSjCI6IihjKSAgKGxpdGVyYXJ5KSBoYXJtb25pb3VzICh2YXJpYW50IG9mIOWSjFtoZTJdKSIsIuiPnCI6IihuKSAgdmVnZXRhYmxlOyBncmVlbnMgKENMOuajtVtrZTFdKSIsIuWWneiMtiI6Iih2KSAgdG8gZHJpbmsgdGVhIiwi6L%2BZ5LqbIjoiKHIpICB0aGVzZSIsIuWkmuWwkSI6IihtKSAgaG93IG11Y2g%2FOyBob3cgbWFueT8iLCLpkrEiOiIobikgIGNvaW4iLCLlhYjnlJ8iOiIobikgIHRlYWNoZXIiLCLkuIDkuKoiOiIobSkgIGE7IGFuOyBvbmUiLCLmna%2FlrZAiOiIobikgIGN1cCIsIuS5sCI6Iih2KSAgdG8gYnV5Iiwi5LiL5Y2IIjoiKHQpICBhZnRlcm5vb24iLCLllYblupciOiIobikgIHN0b3JlOyBzaG9wIiwi5Lic6KW%2FIjoiKG5zKSAgdGhpbmciLCLkuIDngrnlhL8iOiIobSkgIGVyaHVhIHZhcmlhbnQgb2Yg5LiA6buefOS4gOeCuVt5aTEgZGlhbjNdIiwi5rC05p6cIjoiKG4pICBmcnVpdCIsIuS4gCI6IihtKSAgb25lIiwi55yL6KeBIjoiKHYpICB0byBzZWUiLCLnjosiOiIobnIpICAobGl0ZXJhcnkpIChvZiBhIG1vbmFyY2gpIHRvIHJlaWduIG92ZXIgKGEga2luZ2RvbSkiLCLmlrkiOiIobikgIHNxdWFyZSIsIueahCI6Iih1aikgIChib3VuZCBmb3JtKSBidWxsJ3MtZXllOyB0YXJnZXQiLCLlkIzlraYiOiIobikgIHRvIHN0dWR5IGF0IHRoZSBzYW1lIHNjaG9vbCIsIuWQlyI6Iih5KSAgKHF1ZXN0aW9uIHBhcnRpY2xlIGZvciBcInllcy1ub1wiIHF1ZXN0aW9ucykiLCLmiJHku6wiOiIocikgIHdlOyB1czsgb3Vyc2VsdmVzOyBvdXIiLCLpq5jlhbQiOiIoYikgIGhhcHB5Iiwi5aSq5aW95LqGIjoiKGwpICB2ZXJ5IGdvb2QiLCLmnIvlj4siOiIobikgIGZyaWVuZCIsIuaZmuS4iiI6Iih0KSAgZXZlbmluZyIsIuS7luS7rCI6IihyKSAgdGhleTsgdGhlbSIsIuS4gOi1tyI6IihtKSAgKGluKSB0aGUgc2FtZSBwbGFjZSIsIueciyI6Iih2KSAgdG8gc2VlOyB0byBsb29rIGF0Iiwi55S15b2xIjoiKG4pICBtb3ZpZTsgZmlsbSIsIuWWnOasoiI6Iih2KSAgdG8gbGlrZTsgdG8gYmUgZm9uZCBvZiIsIui%2FmeS4qiI6IihyKSAgKHByb25vdW4pIHRoaXMiLCLlrowiOiIodikgIHRvIGZpbmlzaCJ9">
    </div>

    <br />
    <br />
    <br />
    <br />
    <div class="new-words-section"
        data-dictionary="eyLku4rlpKkiOiIodCkgIHRvZGF5Iiwi5pivIjoiKHYpICB2YXJpYW50IG9mIOaYr1tzaGk0XSIsIuaYn%2Bacn%2BS4iSI6Iih0KSAgV2VkbmVzZGF5Iiwi5aSp5rCUIjoiKG4pICB3ZWF0aGVyIiwi5b6IIjoiKHpnKSAgdmVyeTsgcXVpdGUiLCLlpb0iOiIoYSkgIHRvIGJlIGZvbmQgb2Y7IHRvIGhhdmUgYSB0ZW5kZW5jeSB0bzsgdG8gYmUgcHJvbmUgdG8iLCLkuZ8iOiIoZCkgIGFsc287IHRvbzsgYXMgd2VsbDsgKG5vdCAuLi4pIGVpdGhlciIsIuWtpueUnyI6IihuKSAgc3R1ZGVudCIsIuWluSI6IihyKSAgc2hlIiwi5ZyoIjoiKHApICB0byBleGlzdDsgdG8gYmUgYWxpdmUiLCLkuK3lm70iOiIobnMpICBDaGluYSIsIuWtpuS5oCI6Iih2KSAgdG8gbGVhcm4iLCLmsYnor60iOiIobnopICBDaGluZXNlIGxhbmd1YWdlIiwi5LuK5bm0IjoiKHQpICB0aGlzIHllYXIiLCLkuoYiOiIodWwpICB1bm9mZmljaWFsIHZhcmlhbnQgb2Yg556tW2xpYW80XSIsIuS4iuWNiCI6Iih0KSAgbW9ybmluZyIsIuWOuyI6Iih2KSAgdG8gZ28iLCLlrabmoKEiOiIobikgIHNjaG9vbCIsIueci%2BS5piI6Iih2KSAgdG8gcmVhZCIsIuaxieWtlyI6IihueikgIENoaW5lc2UgY2hhcmFjdGVyKHMpIiwi6ICB5biIIjoiKG4pICB0ZWFjaGVyIiwi6ZeuIjoiKG4pICB0byBhc2s7IHRvIGlucXVpcmUiLCLor7fpl64iOiIodikgIEV4Y3VzZSBtZSwgbWF5IEkgYXNrLi4uPyIsIuS9oCI6IihyKSAgeW91IChOb3RlOiBJbiBUYWl3YW4sIOWmsyBpcyB1c2VkIHRvIGFkZHJlc3MgZmVtYWxlcywgYnV0IGluIG1haW5sYW5kIENoaW5hLCBpdCBpcyBub3QgY29tbW9ubHkgdXNlZC4gSW5zdGVhZCwg5L2gIGlzIHVzZWQgdG8gYWRkcmVzcyBib3RoIG1hbGVzIGFuZCBmZW1hbGVzLikiLCLlj6siOiIodikgIHZhcmlhbnQgb2Yg5Y%2BrW2ppYW80XSIsIuS7gOS5iCI6IihyKSAgd2hhdD8iLCLlkI3lrZciOiIobikgIG5hbWUgKG9mIGEgcGVyc29uIG9yIHRoaW5nKSIsIuaIkSI6IihyKSAgSTsgbWU7IG15Iiwi5p2OIjoiKG5yKSAgcGx1bSIsIuaciCI6IihtKSAgbW9vbiIsIueskSI6Iih2KSAgdG8gbGF1Z2g7IHRvIHNtaWxlIiwi6K%2B0IjoiKHYpICB2YXJpYW50IG9mIOiqqnzor7Rbc2h1bzFdIiwi5LiNIjoiKGQpICBubzsgbm90IHNvIiwi576O5Zu9IjoiKG5zKSAgVW5pdGVkIFN0YXRlczsgVVNBOyBVUyIsIuS6uiI6IihuKSAgcGVyc29uOyBwZW9wbGUiLCLkuK3ljYgiOiIodCkgIG5vb24iLCLppa3lupciOiIobikgIHJlc3RhdXJhbnQiLCLlkIPppa0iOiIodikgIHRvIGhhdmUgYSBtZWFsIiwi5oOzIjoiKHYpICB0byB0aGluayAoYWJvdXQpIiwi5ZCDIjoiKHYpICB2YXJpYW50IG9mIOWQg1tjaGkxXSIsIuexs%2BmlrSI6IihuKSAgKGNvb2tlZCkgcmljZSIsIuWSjCI6IihjKSAgKGxpdGVyYXJ5KSBoYXJtb25pb3VzICh2YXJpYW50IG9mIOWSjFtoZTJdKSIsIuiPnCI6IihuKSAgdmVnZXRhYmxlOyBncmVlbnMgKENMOuajtVtrZTFdKSIsIuWWneiMtiI6Iih2KSAgdG8gZHJpbmsgdGVhIiwi6L%2BZ5LqbIjoiKHIpICB0aGVzZSIsIuWkmuWwkSI6IihtKSAgaG93IG11Y2g%2FOyBob3cgbWFueT8iLCLpkrEiOiIobikgIGNvaW4iLCLlhYjnlJ8iOiIobikgIHRlYWNoZXIiLCLkuIDkuKoiOiIobSkgIGE7IGFuOyBvbmUiLCLmna%2FlrZAiOiIobikgIGN1cCIsIuS5sCI6Iih2KSAgdG8gYnV5Iiwi5LiL5Y2IIjoiKHQpICBhZnRlcm5vb24iLCLllYblupciOiIobikgIHN0b3JlOyBzaG9wIiwi5Lic6KW%2FIjoiKG5zKSAgdGhpbmciLCLkuIDngrnlhL8iOiIobSkgIGVyaHVhIHZhcmlhbnQgb2Yg5LiA6buefOS4gOeCuVt5aTEgZGlhbjNdIiwi5rC05p6cIjoiKG4pICBmcnVpdCIsIuS4gCI6IihtKSAgb25lIiwi55yL6KeBIjoiKHYpICB0byBzZWUiLCLnjosiOiIobnIpICAobGl0ZXJhcnkpIChvZiBhIG1vbmFyY2gpIHRvIHJlaWduIG92ZXIgKGEga2luZ2RvbSkiLCLmlrkiOiIobikgIHNxdWFyZSIsIueahCI6Iih1aikgIChib3VuZCBmb3JtKSBidWxsJ3MtZXllOyB0YXJnZXQiLCLlkIzlraYiOiIobikgIHRvIHN0dWR5IGF0IHRoZSBzYW1lIHNjaG9vbCIsIuWQlyI6Iih5KSAgKHF1ZXN0aW9uIHBhcnRpY2xlIGZvciBcInllcy1ub1wiIHF1ZXN0aW9ucykiLCLmiJHku6wiOiIocikgIHdlOyB1czsgb3Vyc2VsdmVzOyBvdXIiLCLpq5jlhbQiOiIoYikgIGhhcHB5Iiwi5aSq5aW95LqGIjoiKGwpICB2ZXJ5IGdvb2QiLCLmnIvlj4siOiIobikgIGZyaWVuZCIsIuaZmuS4iiI6Iih0KSAgZXZlbmluZyIsIuS7luS7rCI6IihyKSAgdGhleTsgdGhlbSIsIuS4gOi1tyI6IihtKSAgKGluKSB0aGUgc2FtZSBwbGFjZSIsIueciyI6Iih2KSAgdG8gc2VlOyB0byBsb29rIGF0Iiwi55S15b2xIjoiKG4pICBtb3ZpZTsgZmlsbSIsIuWWnOasoiI6Iih2KSAgdG8gbGlrZTsgdG8gYmUgZm9uZCBvZiIsIui%2FmeS4qiI6IihyKSAgKHByb25vdW4pIHRoaXMiLCLlrowiOiIodikgIHRvIGZpbmlzaCJ9"
    ></div>
</div>
<!-- Pinyin Pro -->
<script src="https://cdn.jsdelivr.net/npm/pinyin-pro"></script>

<!-- Include Marked.js (Markdown parser) -->
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<script>
    function isHanzi(char) {
        return /[\u4e00-\u9fff]/.test(char);
    }

    function decodeDictionary(encodedString) {
        

        const urlDecoded = decodeURIComponent(encodedString)
        const binaryString = atob(urlDecoded);
        const bytes = new Uint8Array([...binaryString].map(char => char.charCodeAt(0)));
        const decodedString = new TextDecoder().decode(bytes)
        const dictionary = JSON.parse(decodedString);

        console.log(dictionary)
        return dictionary;
        
    ;
    }

    let activePopover = null; // Track the currently open popover

    function generateMarkdowns() {
        document.querySelectorAll(".markdown-container").forEach(markdownSection => {
            dataMarkdown = decodeURIComponent(markdownSection.getAttribute("data-markdown"));
            markdownSection.innerHTML = marked.parse(dataMarkdown);
        })
    }


    function generateSections() {
        document.querySelectorAll(".new-words-section").forEach(newWordsSection => {
            const dataDictionary = decodeDictionary(newWordsSection.getAttribute("data-dictionary"))
            newWordsSection.innerHTML = "";
            const newWordsDialog = document.createElement("div");
            newWordsDialog.classList.add("dialog-new-words");

            const title = document.createElement("p");
            title.classList.add("hanzi-line")

            const titleSpan = document.createElement("span");
            titleSpan.classList.add("plain-text-title");
            titleSpan.textContent = "New Words";
            title.appendChild(titleSpan);
            newWordsDialog.appendChild(title);

            for(let word in dataDictionary) {
                const entry = document.createElement("p");
                entry.classList.add("hanzi-line");
                createHanziSpan(entry, word, dataDictionary);

                const pinyinSpan = document.createElement("span");
                pinyinSpan.classList.add("pinyin-dictionary");
                pinyinSpan.textContent = "   " + (pinyinPro.pinyin(word, { toneType: "mark" }) || "")
                entry.appendChild(pinyinSpan);


                const entrySpan = document.createElement("span");
                entrySpan.classList.add("plain-text");
                entrySpan.textContent = "  :  " + dataDictionary[word];
                entry.appendChild(entrySpan)
                newWordsDialog.appendChild(entry)
            }
            newWordsSection.replaceWith(newWordsDialog);
        })

        document.querySelectorAll(".hanzi-section").forEach(section => {
            const hanziText = section.getAttribute("data-hanzi");
            const textCouples = section.getAttribute("data-translation");
            const dataDictionary = decodeDictionary(section.getAttribute("data-dictionary"))
            const dataTitle = section.getAttribute("data-title");
            const dataMarkdown = section.getAttribute("data-markdown");

            const sectionDiv = document.createElement("div");
            sectionDiv.classList.add("dialog-container");

            generateDialogFromText(sectionDiv, dataTitle, textCouples, dataDictionary, dataMarkdown);

            section.replaceWith(sectionDiv);
        });

        updatePinyinDisplay();
        updateTranslationDisplay();
        initializePopovers();
    }

    function generateDialogFromText(contentDiv, dataTitle, textCouples, dataDictionary, dataMarkdown) {
        contentDiv.innerHTML = ""; // Clear previous content


        const titleDialog = document.createElement("div");
        titleDialog.classList.add("dialog")

        const title = document.createElement("p");
        title.classList.add("hanzi-line")

        const titleSpan = document.createElement("span");
        titleSpan.classList.add("plain-text-title");
        titleSpan.textContent = dataTitle;

        title.appendChild(titleSpan);
        titleDialog.appendChild(title);
        contentDiv.appendChild(titleDialog);  

        const urlDecoded = decodeURIComponent(textCouples)
        const binaryString = atob(urlDecoded);
        const bytes = new Uint8Array([...binaryString].map(char => char.charCodeAt(0)));
        const decodedString = new TextDecoder().decode(bytes)
        const translations = JSON.parse(decodedString);

        translations.forEach((translationGroup, index) => {
            const container = document.createElement("div");
            container.classList.add("dialog");

            const paragraph = document.createElement("p");
            paragraph.classList.add("hanzi-line");

            line = translationGroup[0] // Hanzi
            let indexChar = 0;
            while (indexChar < line.length) {
                let foundWord = false;

                for (let word in dataDictionary) {
                    if (line.startsWith(word, indexChar)) {
                        createHanziSpan(paragraph, word, dataDictionary);
                        indexChar += word.length;
                        foundWord = true;
                        break;
                    }
                }

                if (!foundWord) {
                    let char = line[indexChar];

                    if (isHanzi(char)) {
                        createHanziSpan(paragraph, char, dataDictionary);
                    } else {
                        createPlainTextSpan(paragraph, char);
                    }
                    indexChar++;
                }
            }
            container.appendChild(paragraph);

            // Create translation line
            const translationPara = document.createElement("p");
            translationPara.classList.add("translation");
            translationPara.textContent = translationGroup[1].trim(); // Translation
            container.appendChild(translationPara);
            

            contentDiv.appendChild(container);
        });

        if(dataMarkdown !== null) {
            markdownContainer = document.createElement("div");
            markdownContainer.classList.add("section-markdown-container");
            markdownContent = document.createElement("div");
            markdownContent.innerHTML = marked.parse(decodeURIComponent(dataMarkdown));
            markdownContainer.appendChild(markdownContent);
            contentDiv.appendChild(markdownContainer);
            
        }

        // updatePinyinDisplay();
        // updateTranslationDisplay();
        // initializePopovers(); // **Fix: Ensure popovers are initialized**
    }

    function createHanziSpan(parent, hanziWord, dataDictionary) {
        const pinyinText = pinyinPro.pinyin(hanziWord, { toneType: "mark" }) || "";
        const definition = dataDictionary[hanziWord] || "No definition available";

        const span = document.createElement("span");
        span.classList.add("hanzi-group");
        span.dataset.pinyin = pinyinText;
        span.dataset.bsToggle = "popover";
        span.dataset.bsTrigger = "manual"; 
        span.dataset.bsPlacement = "top";
        span.dataset.bsContent = `<strong>${hanziWord}</strong><br>${pinyinText}<br>${definition}`;
        span.dataset.bsHtml = "true";

        if (pinyinText) {
            const pinyinSpan = document.createElement("span");
            pinyinSpan.classList.add("pinyin");
            pinyinSpan.textContent = pinyinText;
            span.appendChild(pinyinSpan);
        }

        span.appendChild(document.createTextNode(hanziWord));
        parent.appendChild(span);
    }

    function createPlainTextSpan(parent, text) {
        const span = document.createElement("span");
        span.classList.add("plain-text");
        span.textContent = text;
        parent.appendChild(span);
    }

    function updatePinyinDisplay() {
        const isPinyinEnabled = localStorage.getItem("showPinyin") === "true";
        document.querySelectorAll(".dialog-container").forEach(section => {
            section.classList.toggle("show-pinyin", isPinyinEnabled);
        });
        document.getElementById("togglePinyin").checked = isPinyinEnabled;
    }

    function updateTranslationDisplay() {
        const isTranslationEnabled = localStorage.getItem("showTranslation") === "true";
        document.querySelectorAll(".dialog-container").forEach(section => {
            section.classList.toggle("show-translation", isTranslationEnabled);
        });
        document.getElementById("toggleTranslation").checked = isTranslationEnabled;
    }

    document.getElementById("togglePinyin").addEventListener("change", function () {
        localStorage.setItem("showPinyin", this.checked);
        updatePinyinDisplay();
    });

    document.getElementById("toggleTranslation").addEventListener("change", function () {
        localStorage.setItem("showTranslation", this.checked);
        updateTranslationDisplay();
    });

    function initializePopovers() {
        document.querySelectorAll('[data-bs-toggle="popover"]').forEach(el => {
            const popover = new bootstrap.Popover(el);

            el.addEventListener("click", function (event) {
                event.stopPropagation();

                if (activePopover && activePopover !== popover) {
                    activePopover.hide();
                }

                if (activePopover === popover) {
                    activePopover.hide();
                    activePopover = null;
                } else {
                    popover.show();
                    activePopover = popover;
                }
            });
        });

        // Close popovers when clicking outside
        document.addEventListener("click", function (event) {
            if (activePopover && !event.target.closest(".hanzi-group")) {
                activePopover.hide();
                activePopover = null;
            }
        });
    }

    // generateDialogFromText(textBlob, translation);
    generateSections()
    generateMarkdowns()
</script>
    </div>
<footer class="bg-light text-center py-3 mt-4">
    <div class="container">
        <p>&copy; 2025 Made with üíñ by <a href="https://github.com/shadowcodex">shadowcodex</a></p>
    </div>
</footer>
</body>
</html>
